■ 모니터링 및 트러블 슈팅
* 서비스가 가동되고 있는 서버 상에서 실행되는 운영체제 모니터링은 매우 비효율적인 활동 (대부분 보안 솔루션 프로그램 사용)
* 로그분석, 실시간 모니터링
  - 로그분석 : 일정시간 패턴을 두고, 과거에 일어난 결과만을 분석, 즉각 대응이 불가함, 시간적인 여유가 있음.
  - 실시간 모니터링 : 상황에 대한 즉각 대응 가능, 지속적으로 유휴자원(인력, 시간, CPU)을 소비
  - 둘 다 병합을 하여 실시함.

* Ctrl+Shift+ESC(Ctrl+Alt+Del) 작업 관리자
  - 교착상태로 인한 딤드(Deemed) >> 작업 관리자 불러내고, >> 지속적으로 마우스 키보드 등을 클릭 >> 마우스, 키보드 등의 입력기조차 먹히지 않음.(Dead Lock 상태)
  - 집에서 프로그램 뻑났는데, 작업 관리자 열어서 "응용 프로그램" 상에서 작업 끝내기 광클 >> 이 또한 작업.
  - 작업(프로그램) < 프로세스 < 서비스
  - 서비스를 죽이면, PC 재부팅을 하기 전까진 해당 서비스 다시 사용 불가.
  - CPU 사용량이 급증했을 때, 문제 유형 판별하는 방법
	- "네트워킹" 또는 와이어샤크로 점검
	- 랜포트를 차단해본다. (외부적 공격, DDOS 등)
	- 프로세스에서 메모리와 CPU값이 급증하는 프로그램이 있는지 찾는다. (악성코드 등)
	  >> 안전모드로 접속하여 백신 실행 / 운영체제가 RAM에 올라오기 전에 돌아가는 백신
	  >> 포맷을 해도 지워지지 않으므로(랜섬웨어 등) 파티션 삭제 후, 파티션을 다시 설치 (로우포맷이 좋으나, 시간이 오래걸림)
  - 좀비 PC와 같이, 원격으로 접속되어있을 때, net state / 작업 관리자의 "사용자"탭 / arp table등 점검

■ 작업관리자 
   <응용 프로그램>
    - 현재 시스템 상에서 실행중인 프로그램들의 상태 표시
      작업 끝내기 : 응용 프로그램 중단
      전환 : 해당 응용 프로그램이 선택되고 활성화
      새 작업 : 새로운 프로그램을 실행 (실행할 프로그램 명령을 입력)
   <프로세스>
    - 실행중인 프로세스에 대한 상세 정보
    - 로컬 서비스에 이해 시작되거나 로컬 콘솔에 대화식으로 로그온한 사용자나 원격 사용자들에 의해 실행중인 모든 프로세스 표시
      프로세스 이름 : 프로세스나 프로세스를 실행하는 실행 파일 이름
      사용자 이름 : 프로세스를 실행하는 사용자 또는 시스템 서비스의 이름
      CPU : 프로세스의 CPU 사용량
      메모리 [개인 작업 집합] : 프로세스가 현재 사용하고 있는 메모리의 양
      설명 : 프로세스에 대한 설명
   <서비스>
    - 시스템 서비스에 대한 개요 정보 제공
      이름 : 서비스 이름
      PID : 서비스에 대한 프로세스 식별 번호
      설명 : 서비스에 대한 설명
      상태 : 현재 서비스의 상태 표시
      그룹 : 서비스가 어떠한 계정 하에서 혹은 어떠한 서비스 호스트 컴텍스트() 정보 하에서 실행되고있는지에 대한 추가적인 정보 제공
   <성능>
    - CPU 및 메모리 사용량에 대한 개요 제공
      CPU 사용 : 현재 사용되고 있는 프로세서 사용량의 백분율
      CPU 사용 현황 : 시간에 따른 CPU 사용량 이력 그래프
      메모리 : 시스템에 의해 현재 사용되고 있는 메모리 사용량
      실제 메모리 사용 현황 : 시간에 따른 물리 메모리 사용량 이력 그래프
   <네트워킹>
    - 네트워크 어댑터에 대한 개요를 제공
    - 이용률, 링크 속도, 그리고 시스템에 구성된 각 네트워크 어댑터의 작동 상태 등을 확인
      그래프 : 네트워크 트래픽의 전체 바이트 수
      어댑터 이름 : [네트워크 연결] 폴더 내에 존재하는 네트워크 어댑터의 이름
      네트워크 이용률 : 인터페이스의 초기 연결 속도에 대한 현재 네트워크 사용률(%)
      연결 속도 : 초기 연결 속도에 의해 결정된 인터페이스의 속도
      상태 : 네트워크 어댑터의 작동 상태

■ 데이터 저장소 관리 (압축, EFS, 할당량)
- 파일 압축이란?
  * NTFS 파티션에 각 파일과 폴더단위 압축이 가능하다.
  * 현재 폴더만 또는 현재 폴더의 하위 폴더 및 파일을 선택적으로 압축할 수 있다.
  * 폴더를 압축하면 폴더에 생성되는 모든 파일과 디렉터리는 생성되는 시점에 자동으로 압축된다
  * 압축된 데이터에 접근하는 것은 압축되지 않은 데이터에 접근하는 것과 동일하다.
  * Disk 공간은 압축되기 전 파일 크기만큼 할당된다.
  * 시스템 파일과 폴더는 압축하지 않는다.

■ 데이터 저장소 관리 실습
파일 압축의 목적 1. 용량 축소
파일 압축의 목적 2. 단일화 시키는 목적이 있음.

압축 방법 1. 압축 유틸리티 사용 (알집, Winrar, 별집 등)
압축 방법 2. 폴더 압축 (Windows Server 2012)
	     - 압축 유틸리티와의 차이점 : 별도로 압축 패키지를 해제할 필요가 없음. 즉시 실행 가능.
					  (접근 권한이 부여된 계정에서 접속 시도시, 압축을 풀어서 접근할 수 있도록 함)
					  (단, 단일 실행 프로그램만 가능(링크된 프로그램 불가). 장기간 보관해야하는데 자주 쓰지 않는 Data를 관리하기에 용이함)
					  (권한 상속과 같은 특징을 가진다. (동일 또는 다른 드라이브로 복사시 META정보가 초기화되면서, 압축이 풀려버리고, 
					   이동시킨 경우에는 경로정보만 변경되므로 압축 속성이 그대로 유지된다. )

adds, 디스크 관리

Disk 1, 2 MBR 새 단순볼륨, NTFS(1), FAT32(2)
C:\Program Files를 E:\로 복사
복사된 폴더 "속성"
크기 : 실제 데이터의 크기
디스크 할당 크기 : 할당된 클러스터의 크기

1 섹터 = 512 Byte
8 섹터 = 클러스터
1 클러스터 = 4096 Byte (4 Kb)
(파일은 클러스터 단위로 저장)

영문, 숫자, Spacebar, Tab : 1 Byte
한글, 특수문자 : 2 Byte

(1.txt 3000 Byte---------         ) 4096 Byte/Cluster
(2.txt 100 Byte                   )
(3.txt 7000 Byte------------------)
(---------------------------------)

클러스터 용량을 크게 하면, 
1. 클러스터의 수가 적어지고, 흩어진 클러스터를 불러들이는 속도가 빨라짐. 파일 속도가 빨라짐.
2. 효율성이 떨어짐 (데이터의 낭비 공간이 많아짐)

클러스터 용량을 작게 하면, 
1. 클러스터의 수가 많아지고, 흩어진 클러스터를 불러들이는 속도가 느려짐. 파일 속도가 느려짐.
2. 효율성이 커짐 (데이터 유효 사용량이 많음.)

디스크 조각모음
1. 15%정도에서 실행하면 적당
2, SSD는 조각모음 하지 말 것. (해줄 필요도 없음)
   (휘발성 데이터를 비휘발성으로 고정시킨 형태로, 읽기 및 쓰기 횟수가 지정되어있음.)
   (읽기 및 쓰기 횟수를 소모시키는 조각모음은 SSD의 수명을 단축시킴)
   (Meta정보를 따라 조회하는 방식이므로, 해줄 필요도 없음)



- 파일 암호화
계정이 인증서를 가지고 있는 경우에만 열람 가능. (인증키를 발생시킨(잠근) 계정에서만 열 수 있음.)
다른 계정으로 접근시 액세스가 거부되는 것을 볼 수 있음.
(META 정보를 열람할 수 있는 권한 자체가 제한되었음)

1. administrator로 접속하여, "E:\암호화 실습" 생성, 내부에 Text 생성 "비밀 문서"
2. 우클릭, 고급, 암호화
3. User1으로 접속, 액세스 가능성 확인
4. "E:\암호화 실습_user1" 생성, 내부에 Text "비밀문서" 생성
5. administrator로 접속, 액세스 가능성 확인.
6. E:\에 새로운 Text를 만들고, "암호화 실습_User1"으로 이동, 암호화 속성이 이어지는 것을 확인.
7. 다시 E:\로 이동시킨다. 한번 암호화가 되면, 그 특성이 유지되는 것을 확인.
8. 이 Text 파일을 열람할 수 있는 권한이 누구에게 있는지 확인한다. (Admin? User1?)

- 인증서 확인
* certmgr.msc
  좌측 "신뢰할 수 있는 사용자", "인증서" >> 키 모양이 있는 인증서는 기본 인증서, 키 모양이 없는 인증서는 만들어진 인증서.
  (인증서를 만들 당시, 백업본이 만들어졌기때문에, certmgr에 있는 인증서를 삭제해도 문제는 없음.)

■ 파일 시스템 암호화(Encrypting File System)란?
* Encrypting File System
* EFS Encrypts data
  - 폴더와 파일에 암호화 특성을 설정함으로써 폴더나 파일을 암호화하거나 복호화할 수 있다.
  - 폴더를 암호화하면 암호화 된 폴더에 만들어지는 모든 파일과 하위 폴더도 자동으로 암호화된다. 암호화는 폴더 수준에서 수행하는 것이 좋다.
* Use EFS to Access Encrypted data
  - 암호화된 파일도 일반 파일과 동일하게 읽고 쓸 수 있다.
  - 사용자가 파일을 읽는 동안 자동으로 암호화가 해제된다
  - 사용자가 파일을 닫으면 다시 EFS 암호화 된다.
  - 암호화된 파일은 파일을 암호화한 사람만이 읽을 수 있다.
* Use EFS to Decrypt data
  - 암호화 해제하는 방법은 암호화를 하기 위해 선택한 암호화 특성을 체크 해제한다.
* Cipher 명령을 이용하여 NTFS Volume에 파일 또는 폴더에 암호화 속성을 보거나 변경할 수 있다.


■ Web Service (IIS)
adds, DC설치 / client100, 멤버도메인 / client200, 초기설치 복원

홈페이지를 만드는 것이 아닌, 페이지 서비스를 개설하는 것.

adds, 서버관리자 역할 추가
기능 : 웹서버 (IIS) 추가
역할 서비스 : "응용 프로그램 개발" 제외 모두 추가
설치 완료 후, Internet Explore를 실행하고, http://itbank.com을 접속. 

client100, Exolorer 실행 후, http://itbank.com을 접속. (됨)
client200, Exolorer 실행 후, http://itbank.com을 접속. (안됨) DNS 설정이 안되있어서, 도메인을 찾을 수 없음.
	   ncpa.cpl 어댑터 속성 > DNS에 172.16.0.1 설정하면 됨.

adds, Win+E 
IIS 설치시, C;\inetpub가 생성됨.
wwwroot의 iisstart 파일을 보면, 시작화면이 있음을 알수 있음.
wwwroot 폴더 내보에 메모장을 생성 후, 내용 작성 후(이 사이트는 연습용 사이트입니다.),index.html로 저장
서유럽어 >> 한국어로 전환시켜주면, 제대로 실행되는 것을 볼 수 있음.
시작 >> 관리도구 >> IIS 관리자 (6.0 관리자 아님) >> 좌측 adds, 응용 프로그램 풀, 사이트, Default Web Site, 기본문서에서 시작 페이지 설정 가능

웹사이트 만들기
1. DNS 만들기 
   dnsmgmt.msc >> adds, 정방향 조회 영역, itbank.com 선택
	(정방향 : 이름을 IP 주소로, 역방향 : IP주소를 이름으로 (서버의 출처, 특히 메일 서버의 출처를 역추적할 때나 사용))
   우클릭, 새 호스트, 이름에 www를 입력하여 FQDN을 www.itbank.com으로 만들고, 서버 주소(172.16.0.1) 입력

   client200에서, www.itbank.com으로 ping 전송 하였을 때, 정상전송 되면 준비 완료

2. 시작 페이지 준비
   "C:\www" 생성 후, 안에 메모장으로 html 파일을 만든다. (굳이 inetpub의 wwwroot에 만들어야할 필요는 없다.)


3. IIS 관리자에서 웹사이트 추가
   좌측 adds, 사이트 우클릭, "웹 사이트 추가"
   - 사이트 이름은 적절하게 추가
   - 실제 경로 : 홈페이지가 있는 경로
   - 바인딩 : http, ftp, https를 지원함.
              포트를 80에서 변경시, 홈페이지 뒤에 ":8080" 등과 같은 추가사항을 붙여줘야 하므로 불편함.
	      같은 Device에 있는 Web Service를 중복되지 않게 하려는 것.
	      호스트를 둔 경우, 호스트가 IP를 변경한 경우, 다시 설정해주어야하고, 해당 이름이 조금만 틀려도 연결이 안됨.

client100나 200에서 www.itbank.com으로 접속 시도.
>> 403 Error 발생. 추가적인 절차가 있어야함.

4. itbank.html을 시작페이지에 구성.
   연습용 사이트 >> 기본문서 >> 우클릭, "추가" >> 추가시, 뒤 확장자까지 정확하게 입력해야함.

=========================================================================================================================================
예제
adds : 네트워크 카드 추가 (호스트 전용)
       172.16.0.2/24 부여
       ppp.itbank.com으로, 홈페이지는 좋아하는 연예인 사진으로 (호스트 구글에서 내려받기, 파일명은 간단하게, 단 html로 변경X)

       전부 세팅 후 client100에서 열어서 확인

1. 네트워크 카드를 추가

2. ncpa.cpl에서, 어댑터 2 IPv6해제, 172.16.0.1 / 255.255.255.0 / GW 미지정 / DNS 127.0.0.1
   설정 후, 200에서 확인 (ip 핑)

3. dnsmgmt.msc 새 호스트 추가, [이름] 172.16.0.2
   설정 후, 200에서 확인 ([이름].itbank.com)

4. 폴더 하나 만들고, 사진 넣기

5. IIS 관리자에서, 사이트 우클릭, 웹사이트 추가
   이름, 경로(폴더) 적용
   둘 다 설정을 못하므로, IP로 바인딩하여 기존 만들어진 172.16.0.1과 겹치는걸 방지한다.
   
6. 확인해본다.
   Q. 사진 깨지는건 어떻게 대처?
      (IP 바인딩을 하지 않고, 8080으로 포트 바인딩을 적용한 경우, 사진이 깨졌다.)

=========================================================================================================================================

추가
블랙리스트, 화이트리스트
접속 가능 표본의 수 차이로 인해 화이트리스트의 보안성이 높음.

블랙리스트로 만들기.
- 해당 사이트, "IP 주소 및 도메인 제한" 우클릭, 거부 항목으로 추가
  403 -> IP가 막힌거거나, 기본문서가 삭제되었거나.
	 (지금은 권한적인 문제)

블랙리스트는, Proxy 등 여러 우회방안으로 인해 통과 가능.
그렇다고 화이트리스트로 만들면, 해당 IP, 해당 자리에서만 접속이 가능하므로 좋은 방법은 아님.

인증 개념을 도입하면 됨.
1. dsa.msc에서, 전용으로 사용할 계정을 생성.

2. 익명 인증 -> 사용 안함으로 전환,
   Windows 인증 -> 사용으로 전환

3. "권한 부여 규칙" -> "모든 사용자" 우클릭, "지정한 사용자"로 변경 후, 아까 만든 계정을 입력.

4. 


리디렉션
1. "http 리디렉션", http://testing.itbank.com을 입력 후, 우측 상단 "적용" 클릭

■ FTP
1. 폴더 생성
"C:\영화 FTP\한국"
"C:\영화 FTP\해외"
"C:\영화 FTP\애니"
"C:\영화 FTP\YDYD" 생성

2. IIS에서 FTP 서버 개설
IIS 관리자 실행, 좌측 탭 "사이트" 우클릭 후, 새 FTP 서버 추가
(SSL 사용 안함 익명, 모든 사용자 / 읽기 및 쓰기 설정 후)

3. 폴더 권한 수정
폴더에 대한 권한을 별도로 지정해주지 않으면, 서비스상 오류가 날 수 있음.

4. dnsmgmt.msc에서, 새 호스트로 ftp를 추가.

5. client200에서 ftp를 조작하고 싶은 경우,
   폴더 아무거나 하나 열어서, 경로를 ftp://ftp.itbank.com으로 바꿔주면, 해당 폴더 형식으로 접속 가능

--------------------------------------------------------------------------------------------------------

1. 학생계정 3개 생성 (st1, st2, st3)

2. 폴더 및 TXT 생성
   "C:\컴공과 FTP\itbank\st1\st1.txt"
   "C:\컴공과 FTP\itbank\st1\st2.txt"
   "C:\컴공과 FTP\itbank\st1\st3.txt"

3. 익명, 기본, 모든 사용자, 읽기, 쓰기

4. "사용자 격리" "사용자 이름 디렉터리" ,적용

5. 폴더 권한 설정
	everyone / st1,st2,st3

(* 서버가 워크그룹 상태일 때, 사용자 격리 방법이 다르다. localuser "Netbios"가 아닌라고 써야함.








SP4KRGM9cbc82